freq(Base_T$odeurs)
freq(Base_T$gps)
freq(Base_T$senti_securite)
#c'est déjà mieux je pense pas qu'on puisse faire plus
## Recodage réordonner les variables ----
## Réordonnancement de Base_T$senti_securite
Base_T$senti_securite <- Base_T$senti_securite %>%
fct_relevel(
"Pas vraiment", "La plupart du temps", "Tout le temps"
)
## Réordonnancement de Base_T$bruits
Base_T$bruits <- Base_T$bruits %>%
fct_relevel(
"Non, pas spécialement", "Oui, un peu", "Oui, beaucoup"
)
## Réordonnancement de Base_T$freq_ballade
Base_T$freq_ballade <- Base_T$freq_ballade %>%
fct_relevel(
"Jamais ou rarement", "Au moins une fois par mois", "Au moins une fois toutes les semaines",
"Tous les jours"
)
## Réordonnancement de Base_T$mobi_ext
Base_T$mobi_ext <- Base_T$mobi_ext %>%
fct_relevel(
"Non, rarement ou jamais", "Oui, quelques fois par mois", "Oui, une ou plusieurs fois par semaine",
"Oui, une ou plusieurs fois par jour"
)
# Recodage des variables Base_A ----
## Recodage des modalités ----
# Recodage de Base_A$attachement (je met le 13 en 10)
Base_A$attachement_rec <- Base_A$attachement %>%
as.character() %>%
fct_recode(
"10" = "13"
)
#Recodage de l'âge en quintiles
Base_A$age_quint <- quant.cut(Base_A$age, 5)
freq(Base_A$age_quint) #le découpage est pas si mal et les catégories m'ont pas l'air si bizarres
## Recodage de Base_A$age_quint
Base_A$age_quint <- Base_A$age_quint %>%
fct_recode(
"14-20 ans" = "[14,20.4)",
"21-32 ans" = "[20.4,32)",
"33-46 ans" = "[32,46)",
"47-62 ans" = "[46,62.6)",
"63-87 ans" = "[62.6,87]"
)
freq(Base_A$age_quint)
#recodage de l'ancienneté ? (essai)
Base_A$anciennete_rec <- quant.cut(Base_A$anciennete, 5)
freq(Base_A$anciennete_rec) #les catégories m'ont l'air bien
## Recodage de Base_A$anciennete_rec
Base_A$anciennete_rec <- Base_A$anciennete_rec %>%
fct_recode(
"0 à 2,5 ans" = "[0,2.5)",
"2,5 à 6 ans" = "[2.5,6)",
"6 à 12 ans" = "[6,12)",
"13 à 23 ans" = "[12,23.6)",
"24 à 70 ans" = "[23.6,70]"
)
freq(Base_A$anciennete_rec)
##Réordonnancement des variables ----
## Réordonnancement de Base_A$revenu
Base_A$revenu <- Base_A$revenu %>%
fct_relevel(
"Moins de 1250 euros", "Entre 1250 et 2000 euros", "Entre 2000 et 3000 euros",
"Entre 3000 et 4500 euros", "Entre 4500 et 6000 euros", "Entre 6000 et 8000 euros",
"Plus de 8000 euros"
)
## Réordonnancement de Base_A$diplome
Base_A$diplome <- Base_A$diplome %>%
fct_relevel(
"Sans diplôme", "Inférieur au bac", "Bac", "Bac+2/+3", "Bac+5 et supérieur"
)
freq(Base_A$anciennete_rec)
freq(Base_A$revenu)
freq(Base_A$diplome)
freq(Base_A$age_quint)
# RECODAGE 2 DE B07Q01 : une modalité de transport par personne ----
# Créer des modalités pour ceux qui ont répondu au moins une fois un mode de transport ----
Marche <- QB[QB$`B07Q01[SQ001]`=="Oui", ]
Metro_RER <- QB[QB$`B07Q01[SQ006]`=="Oui", ]
Voiture <- QB[QB$`B07Q01[SQ005]`=="Oui", ]
Vélo <- QB[QB$`B07Q01[SQ002]`=="Oui", ]
Tram_bus <- QB[QB$`B07Q01[SQ007]`=="Oui", ]
Trottinette <- QB[QB$`B07Q01[SQ003]`=="Oui", ]
Scooter_moto <- QB[QB$`B07Q01[SQ004]`=="Oui", ]
rm(Trottinette)
rm(Scooter_moto)
#On crée une grosse base de données avec toutes nos variables recodées----
Base_All <- inner_join(Base_A, Base_T, by = "id")
View(Base_All)
# Problème : il y a des individus en double
Base_All <- Base_All %>%
distinct(id, .keep_all = TRUE)
View(Base_All)
# Problème réglé
nrow(Base_All)
# Même problème d'ailleurs pour Mode de transport
Mode_transport <- Mode_transport %>%
distinct(id, .keep_all = TRUE)
nrow(Mode_transport)
##################################### RECODAGE POSTÉRIEUR #########################
# Recodage attachement en classe ----
Base_All$attachement_classe <- Base_All$attachement_rec %>%
fct_recode(
"[0-4]" = "0",
"[0-4]" = "1",
"[8-10]" = "10",
"[0-4]" = "2",
"[0-4]" = "3",
"[0-4]" = "3.5",
"[0-4]" = "4",
"[5-7]" = "5",
"[5-7]" = "5.5",
"[5-7]" = "6",
"[5-7]" = "6.5",
"[5-7]" = "7",
"[8-10]" = "7.5",
"[8-10]" = "8",
"[8-10]" = "8.5",
"[8-10]" = "9",
"[8-10]" = "9.5"
)
# On réordonne les classes d'attachement
Base_All$attachement_classe <- Base_All$attachement_classe %>%
fct_relevel(
"[8-10]", "[5-7]", "[0-4]"
)
# Mettre la variable mode de transport dans Base_All pour pouvoir faire des graphiques ----
Mode_transport$reponses_rec1
Base_All$reponses_rec1 <- Mode_transport$reponses_rec1
Base_All <- Base_All %>%
left_join(Mode_transport %>% select(id, reponses_rec1), by = "id")
# Vérification
table(Mode_transport$reponses_rec1)
table(Base_All$reponses_rec1.x)
# RECODAGE : selon mode souterrain ou plein air ----
# Notre variable est : Base_All$reponses_rec2
#Recodage
## Recoding Base_All$reponses_rec1.x into Base_All$reponses_rec1.x_rec
Base_All$Transport_pleinair <- Base_All$reponses_rec1.x %>%
fct_recode(
"Plein air" = "tram, bus",
"Sous-terrain" = "métro, RER",
"Mixte" = "métro, RER / tram, bus",
"Plein air" = "voiture",
"Mixte" = "voiture/ métro, RER",
"Plein air" = "scooter, moto (+ autre)",
"Plein air" = "vélo",
"Plein air" = "vélo / tram, bus ou voiture",
"Mixte" = "vélo / métro, RER",
"Plein air" = "vélo / voiture",
"Plein air" = "marche",
"Plein air" = "marche / tram, bus ou voiture",
"Mixte" = "marche / métro, RER",
"Plein air" = "marche / voiture",
"Plein air" = "marche / scooter, moto",
"Plein air" = "marche / vélo"
)
table(Base_All$Transport_pleinair)
# le problème c'est que sous-terrain on a peu d'effectifs => On a que les full métro/ RER, après
# c'est des mixtes
# faisons quelques test pour voir la pertinence du recodage
# Avec attachement
Base_All_NA <- Base_All %>%
drop_na(Transport_pleinair, attachement_classe)
ggplot(Base_All_NA) +
aes(x = attachement_classe, fill = Transport_pleinair) +
geom_bar(position = "fill") +
scale_fill_hue(direction = 1) +
theme_minimal()
chisq.test(table(Base_All$Transport_pleinair, Base_All$attachement_classe )) #p-value moyen (11%)
# Avec rester
Base_All_NA <- Base_All %>%
drop_na(Transport_pleinair, rester)
ggplot(Base_All_NA) +
aes(x = rester, fill = Transport_pleinair) +
geom_bar(position = "fill") +
scale_fill_hue(direction = 1) +
theme_minimal()
chisq.test(table(Base_All$Transport_pleinair, Base_All$rester )) #p-value nulle (48%)
# Avec gps - seul résultat intéressant
Base_All_NA <- Base_All %>%
drop_na(Transport_pleinair, gps)
ggplot(Base_All_NA) +
aes(x = gps, fill = Transport_pleinair) +
geom_bar(position = "fill") +
scale_fill_hue(direction = 1) +
theme_minimal()
chisq.test(table(Base_All$Transport_pleinair, Base_All$gps )) #p-value top (0.001%)
# Voyons si on met les mixtes en sous-terrain
Base_All$Transport_pleinair2 <- Base_All$reponses_rec1.x %>%
fct_recode(
"Plein air" = "tram, bus",
"Sous-terrain" = "métro, RER",
"Sous-terrain" = "métro, RER / tram, bus",
"Plein air" = "voiture",
"Sous-terrain" = "voiture/ métro, RER",
"Plein air" = "scooter, moto (+ autre)",
"Plein air" = "vélo",
"Plein air" = "vélo / tram, bus ou voiture",
"Sous-terrain" = "vélo / métro, RER",
"Plein air" = "vélo / voiture",
"Plein air" = "marche",
"Plein air" = "marche / tram, bus ou voiture",
"Sous-terrain" = "marche / métro, RER",
"Plein air" = "marche / voiture",
"Plein air" = "marche / scooter, moto",
"Plein air" = "marche / vélo"
)
table(Base_All$Transport_pleinair2)
#Effectifs équilibrés
# Avec rester :
chisq.test(table(Base_All$Transport_pleinair2, Base_All$rester )) #p-value nulle (29%)
# Avec attachement :
chisq.test(table(Base_All$Transport_pleinair2, Base_All$attachement_classe )) #p-value nulle (12%)
# Avec GPS :
chisq.test(table(Base_All$Transport_pleinair2, Base_All$gps )) #p-value top (0.003%)
# CONCLUSION : le recodage ne semble pas hyper pertinent pour analyser l'attachement :'(
# RECODAGE : Moyens de transports collectifs ou individuel -----
## Recoding Base_All$reponses_rec1.x into Base_All$reponses_rec1.x_rec
Base_All$Transport_individuel <- Base_All$reponses_rec1.x %>%
fct_recode(
"collectif" = "tram, bus",
"collectif" = "métro, RER",
"collectif" = "métro, RER / tram, bus",
"individuel" = "voiture",
"mixte" = "voiture/ métro, RER",
"individuel" = "scooter, moto (+ autre)",
"individuel" = "vélo",
"mixte" = "vélo / tram, bus ou voiture",
"mixte" = "vélo / métro, RER",
"individuel" = "vélo / voiture",
"individuel" = "marche",
"mixte" = "marche / tram, bus ou voiture",
"mixte" = "marche / métro, RER",
"individuel" = "marche / voiture",
"individuel" = "marche / scooter, moto",
"individuel" = "marche / vélo"
)
# faisons quelques test pour voir la pertinence du recodage
# Avec attachement
Base_All_NA <- Base_All %>%
drop_na(Transport_individuel, attachement_classe)
ggplot(Base_All_NA) +
aes(x = attachement_classe, fill = Transport_individuel) +
geom_bar(position = "fill") +
scale_fill_hue(direction = 1) +
theme_minimal()
chisq.test(table(Base_All$Transport_individuel, Base_All$attachement_classe )) #p-value nulle (53%)
# Avec rester
Base_All_NA <- Base_All %>%
drop_na(Transport_individuel, rester)
ggplot(Base_All_NA) +
aes(x = rester, fill = Transport_individuel) +
geom_bar(position = "fill") +
scale_fill_hue(direction = 1) +
theme_minimal()
chisq.test(table(Base_All$Transport_individuel, Base_All$rester )) #p-value nulle (41%)
# Avec gps
Base_All_NA <- Base_All %>%
drop_na(Transport_individuel, gps)
ggplot(Base_All_NA) +
aes(x = gps, fill = Transport_individuel) +
geom_bar(position = "fill") +
scale_fill_hue(direction = 1) +
theme_minimal()
chisq.test(table(Base_All$Transport_individuel, Base_All$gps )) #p-value moyen (10%)
# c'est pas non plus un recodage hyper pertinent
# Si on enlève mixte voyons
Base_All$Transport_individuel2 <- Base_All$reponses_rec1.x %>%
fct_recode(
"collectif" = "tram, bus",
"collectif" = "métro, RER",
"collectif" = "métro, RER / tram, bus",
"individuel" = "voiture",
"NA" = "voiture/ métro, RER",
"individuel" = "scooter, moto (+ autre)",
"individuel" = "vélo",
"NA" = "vélo / tram, bus ou voiture",
"NA" = "vélo / métro, RER",
"individuel" = "vélo / voiture",
"individuel" = "marche",
"NA" = "marche / tram, bus ou voiture",
"NA" = "marche / métro, RER",
"individuel" = "marche / voiture",
"individuel" = "marche / scooter, moto",
"individuel" = "marche / vélo"
)
# Graphiques
# Avec attachement
Base_All_NA <- Base_All %>%
drop_na(Transport_individuel2, attachement_classe)
ggplot(Base_All_NA) +
aes(x = attachement_classe, fill = Transport_individuel2) +
geom_bar(position = "fill") +
scale_fill_hue(direction = 1) +
theme_minimal()
chisq.test(table(Base_All$Transport_individuel2, Base_All$attachement_classe )) #p-value nulle (43%)
# Avec rester
Base_All_NA <- Base_All %>%
drop_na(Transport_individuel, rester)
ggplot(Base_All_NA) +
aes(x = rester, fill = Transport_individuel) +
geom_bar(position = "fill") +
scale_fill_hue(direction = 1) +
theme_minimal()
chisq.test(table(Base_All$Transport_individuel2, Base_All$rester )) #p-value nulle (27%)
# Avec gps
Base_All_NA <- Base_All %>%
drop_na(Transport_individuel2, gps)
ggplot(Base_All_NA) +
aes(x = gps, fill = Transport_individuel2) +
geom_bar(position = "fill") +
scale_fill_hue(direction = 1) +
theme_minimal()
chisq.test(table(Base_All$Transport_individuel2, Base_All$gps )) #p-value ça va (5%)
# Recodage non concluant non plus
# RECODAGE : 5 modalités et les autres sous la catégorie "autre"  ----
## Recoding Base_All$reponses_rec1.x into Base_All$Transport_classe
Base_All$Transport_classe <- Base_All$reponses_rec1.x %>%
fct_recode(
NULL = "tram, bus",
NULL = "voiture",
NULL = "voiture/ métro, RER",
NULL = "scooter, moto (+ autre)",
"marche / vélo" = "vélo",
NULL = "vélo / tram, bus ou voiture",
NULL = "vélo / voiture",
"marche / vélo" = "marche",
NULL = "marche / voiture",
NULL = "marche / scooter, moto"
)
# Graphiques
# Avec attachement
Base_All_NA <- Base_All %>%
drop_na(Transport_classe, attachement_classe)
ggplot(Base_All_NA) +
aes(x = Transport_classe, fill = attachement_classe) +
geom_bar(position = "fill") +
scale_fill_hue(direction = 1) +
theme_minimal()
chisq.test(table(Base_All$Transport_classe, Base_All$attachement_classe )) #p-value ça va (5%)
# Avec rester
Base_All_NA <- Base_All %>%
drop_na(Transport_classe, rester)
ggplot(Base_All_NA) +
aes(x = Transport_classe, fill = rester) +
geom_bar(position = "fill") +
scale_fill_hue(direction = 1) +
theme_minimal()
chisq.test(table(Base_All$Transport_classe, Base_All$rester )) #p-value ça va (8%)
# Avec gps
Base_All_NA <- Base_All %>%
drop_na(Transport_classe, gps)
ggplot(Base_All_NA) +
aes(x = Transport_classe, fill = gps) +
geom_bar(position = "fill") +
scale_fill_hue(direction = 1) +
theme_minimal()
chisq.test(table(Base_All$Transport_classe, Base_All$gps )) #p-value très bonne (0.3%)
# Recodage le plus intéressant jusqu'à maintenant
#petit tableau de fréquences pour voir
lprop(table(Base_All$Transport_classe, Base_All$attachement_classe))
lprop(table(Base_All$Transport_classe, Base_All$rester))
# RECODAGE : marche comme variable centrale ----
## Recoding Base_All$reponses_rec1.x into Base_All$Transport_marche
Base_All$Transport_marche <- Base_All$reponses_rec1.x %>%
fct_recode(
"Non" = "tram, bus",
"Non" = "métro, RER",
"Non" = "métro, RER / tram, bus",
"Non" = "voiture",
"Non" = "voiture/ métro, RER",
"Non" = "scooter, moto (+ autre)",
"Non" = "vélo",
"Non" = "vélo / tram, bus ou voiture",
"Non" = "vélo / métro, RER",
"Non" = "vélo / voiture",
"Oui" = "marche",
"Oui" = "marche / tram, bus ou voiture",
"Oui" = "marche / métro, RER",
"Oui" = "marche / voiture",
"Oui" = "marche / scooter, moto",
"Oui" = "marche / vélo"
)
# Regardons la pertinence :
lprop(table(Base_All$Transport_marche, Base_All$attachement_classe))
# Pas d'intérêt
lprop(table(Base_All$Transport_marche, Base_All$rester))
# parmi les personnes qui veulent rester petit sur-représentation des gens qui marchent
# Faisons quelques chi-2
chisq.test(table(Base_All$Transport_marche, Base_All$attachement_classe )) #p-value nulle (43%)
chisq.test(table(Base_All$Transport_marche, Base_All$rester )) #p-value bonne (2%)
# Petit graphique
Base_All_NA <- Base_All %>%
drop_na(Transport_marche, rester)
# Jsp pourquoi mais j'arrive pas trop à enlever les NA
ggplot(Base_All_NA) +
aes(x = Transport_marche, fill = rester) +
geom_bar(position = "fill") +
scale_fill_hue(direction = 1) +
theme_minimal()
# Bon petit lien quand même
# RECODAGE : marche et vélo ----
## Recoding Base_All$reponses_rec1.x into Base_All$Transport_MarcheVélo
Base_All$Transport_MarcheVélo <- Base_All$reponses_rec1.x %>%
fct_recode(
"Non" = "tram, bus",
"Non" = "métro, RER",
"Non" = "métro, RER / tram, bus",
"Non" = "voiture",
"Non" = "voiture/ métro, RER",
"Non" = "scooter, moto (+ autre)",
"Oui" = "vélo",
"Oui" = "vélo / tram, bus ou voiture",
"Oui" = "vélo / métro, RER",
"Oui" = "vélo / voiture",
"Oui" = "marche",
"Oui" = "marche / tram, bus ou voiture",
"Oui" = "marche / métro, RER",
"Oui" = "marche / voiture",
"Oui" = "marche / scooter, moto",
"Oui" = "marche / vélo"
)
chisq.test(table(Base_All$Transport_MarcheVélo, Base_All$attachement_classe )) #p-value nulle (55%)
#CONCLUSION :
# Le seul recodage dont on peut tirer quelque chose est le recodage en 5 catégories
# Idée : les 3 modalités principales sont marche, métro/ RER, tram/bus ----
# Essayer de faire qu'avec ces catégories : qui correspondent à 01, 06 et 07
## Comme les QB07Q01[S00X] sont dans QB on recode vite fait attachement dans QB
QB$attachement_classe <- QB$attachement %>%
as.character() %>%
fct_recode(
"[0-4]" = "0",
"[0-4]" = "1",
"[0-4]" = "2",
"[0-4]" = "3",
"[0-4]" = "3.5",
"[0-4]" = "4",
"[5-7]" = "5",
"[5-7]" = "5.5",
"[5-7]" = "6",
"[5-7]" = "6.5",
"[5-7]" = "7",
"[8-10]" = "7.5",
"[8-10]" = "8",
"[8-10]" = "8.5",
"[8-10]" = "9",
"[8-10]" = "9.5",
"[8-10]" = "10",
"[8-10]" = "13"
)
## Reordering QB$attachement_classe
QB$attachement_classe <- QB$attachement_classe %>%
fct_relevel(
"[8-10]", "[5-7]", "[0-4]"
)
chisq.test(table(QB$`B07Q01[SQ001]`, QB$attachement_classe )) #p-value nulle (24%)
chisq.test(table(QB$`B07Q01[SQ006]`, QB$attachement_classe )) #p-value ça va (5%)
chisq.test(table(QB$`B07Q01[SQ007]`, QB$attachement_classe )) #p-value nulle (68%)
# C'est intéressant que pour métro / RER
ggplot(QB) +
aes(x = attachement_classe, fill = `B07Q01[SQ001]`) +
geom_bar(position = "fill") +
scale_fill_hue(direction = 1) +
theme_minimal()
# plus t'es attaché, plus t'utilise le RER c'est contraire à nos hypothèses mais intéressant
questionr:::irec()
## Recodage de Base_All$Transport_classe (il y avait 2 modalités NA)
Base_All$Transport_classe <- Base_All$Transport_classe %>%
fct_recode(
"NULL" = "NA"
) %>%
fct_explicit_na("NULL")
freq(Base_All$Transport_classe, sort="dec")
Base_All$Transport_classe <- Base_All$Transport_classe %>%
fct_recode(
NULL = "NA"
)
freq(Base_All$Transport_classe, sort="dec")
#ne t'inquiète pas pour ça, c'est pour avoir NA à la place de NULL
Base_All$Transport_classe <- Base_All$Transport_classe %>%
fct_recode(
NULL = "NULL"
)
freq(Base_All$Transport_classe, sort="dec")
write.csv2(freq(Base_All$Transport_classe, sort="dec"),file="Sorties/transports_classe.csv",
fileEncoding="UTF-8")
write.csv2(freq(Base_All$Transport_pleinair2, sort="dec"),file="Sorties/transports_pleinair.csv",
fileEncoding="UTF-8")
##Transports avec marche comme variable centrale ----
freq(Base_All$Transport_marche, sort="dec")
Base_All$Transport_marche <- Base_All$Transport_marche %>%
fct_recode(
NULL = "NA"
)
##Transports avec marche comme variable centrale ----
freq(Base_All$Transport_marche, sort="dec")
write.csv2(freq(Base_All$Transport_marche, sort="dec"), file="Sorties/transports_marche.csv",
fileEncoding="UTF-8")
##Transports avec marche et vélo ----
freq(Base_All$Transport_MarcheVélo, sort="dec")
Base_All$Transport_MarcheVélo <- Base_All$Transport_MarcheVélo %>%
fct_recode(
NULL = "NA"
)
##Transports avec marche et vélo ----
freq(Base_All$Transport_MarcheVélo, sort="dec")
write.csv2(freq(Base_All$Transport_MarcheVélo, sort="dec"), file="Sorties/marche_vélo.csv",
fileEncoding="UTF-8")
